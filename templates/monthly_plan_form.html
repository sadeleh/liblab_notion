{% extends "base.html" %}

{% block title %}{{ 'ุชุนุฏูู ุงูุฎุทุฉ ุงูุดูุฑูุฉ' if plan else 'ุฎุทุฉ ุดูุฑูุฉ ุฌุฏูุฏุฉ' }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6 max-w-4xl">
    <!-- Header -->
    <div class="bg-gradient-to-r from-cyan-50 to-blue-50 rounded-lg p-6 mb-6 border border-cyan-200">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-2xl sm:text-3xl font-bold text-cyan-950 mb-2" dir="rtl">
                    {{ '๐ ุชุนุฏูู ุงูุฎุทุฉ ุงูุดูุฑูุฉ' if plan else 'โ ุฎุทุฉ ุดูุฑูุฉ ุฌุฏูุฏุฉ' }}
                </h1>
                <p class="text-gray-600 text-sm sm:text-base" dir="rtl">
                    {{ 'ูู ุจุชุนุฏูู ุชูุงุตูู ุฎุทุชู ุงูุดูุฑูุฉ' if plan else 'ุฃูุดุฆ ุฎุทุฉ ุดูุฑูุฉ ุฌุฏูุฏุฉ ูุชูุธูู ุฃูุฏุงูู' }}
                </p>
            </div>
            <a href="{{ url_for('monthly_plans') }}" 
               class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200">
                โ ุงูุนูุฏุฉ ูููุงุฆูุฉ
            </a>
        </div>
    </div>

    <!-- Form -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <form method="POST" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Title -->
                <div class="md:col-span-2">
                    <label for="title" class="block text-sm font-medium text-gray-700 mb-2" dir="rtl">
                        ุนููุงู ุงูุฎุทุฉ <span class="text-red-500">*</span>
                    </label>
                    <input type="text" 
                           id="title" 
                           name="title" 
                           value="{{ plan.title if plan else '' }}"
                           required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent"
                           placeholder="ูุซุงู: ุฎุทุฉ ุณุจุชูุจุฑ 2025 - ุงูุชุทููุฑ ุงููููู"
                           dir="rtl">
                </div>

                <!-- Month -->
                <div>
                    <label for="month" class="block text-sm font-medium text-gray-700 mb-2" dir="rtl">
                        ุงูุดูุฑ <span class="text-red-500">*</span>
                    </label>
                    <select id="month" 
                            name="month" 
                            required 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500">
                        {% set months = [
                            (1, 'ููุงูุฑ'), (2, 'ูุจุฑุงูุฑ'), (3, 'ูุงุฑุณ'), (4, 'ุฃุจุฑูู'),
                            (5, 'ูุงูู'), (6, 'ููููู'), (7, 'ููููู'), (8, 'ุฃุบุณุทุณ'),
                            (9, 'ุณุจุชูุจุฑ'), (10, 'ุฃูุชูุจุฑ'), (11, 'ููููุจุฑ'), (12, 'ุฏูุณูุจุฑ')
                        ] %}
                        {% for month_num, month_name in months %}
                        <option value="{{ month_num }}" 
                                {{ 'selected' if plan and plan.month == month_num else 'selected' if not plan and month_num == current_month else '' }}>
                            {{ month_name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Year -->
                <div>
                    <label for="year" class="block text-sm font-medium text-gray-700 mb-2" dir="rtl">
                        ุงูุณูุฉ <span class="text-red-500">*</span>
                    </label>
                    <select id="year" 
                            name="year" 
                            required 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500">
                        {% for year in range(2024, 2030) %}
                        <option value="{{ year }}" 
                                {{ 'selected' if plan and plan.year == year else 'selected' if not plan and year == current_year else '' }}>
                            {{ year }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Priority -->
                <div>
                    <label for="priority" class="block text-sm font-medium text-gray-700 mb-2" dir="rtl">ุงูุฃููููุฉ</label>
                    <select id="priority" 
                            name="priority" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500">
                        <option value="low" {{ 'selected' if plan and plan.priority == 'low' else '' }}>ููุฎูุถ</option>
                        <option value="medium" {{ 'selected' if plan and plan.priority == 'medium' else 'selected' if not plan else '' }}>ูุชูุณุท</option>
                        <option value="high" {{ 'selected' if plan and plan.priority == 'high' else '' }}>ุนุงูู</option>
                    </select>
                </div>

                <!-- Category -->
                <div>
                    <label for="category" class="block text-sm font-medium text-gray-700 mb-2" dir="rtl">ุงููุฆุฉ</label>
                    <select id="category" 
                            name="category" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500">
                        <option value="general" {{ 'selected' if plan and plan.category == 'general' else 'selected' if not plan else '' }}>ุนุงู</option>
                        <option value="work" {{ 'selected' if plan and plan.category == 'work' else '' }}>ุนูู</option>
                        <option value="personal" {{ 'selected' if plan and plan.category == 'personal' else '' }}>ุดุฎุตู</option>
                        <option value="health" {{ 'selected' if plan and plan.category == 'health' else '' }}>ุตุญุฉ</option>
                        <option value="education" {{ 'selected' if plan and plan.category == 'education' else '' }}>ุชุนููู</option>
                        <option value="finance" {{ 'selected' if plan and plan.category == 'finance' else '' }}>ูุงููุฉ</option>
                        <option value="family" {{ 'selected' if plan and plan.category == 'family' else '' }}>ุนุงุฆูุฉ</option>
                        <option value="hobbies" {{ 'selected' if plan and plan.category == 'hobbies' else '' }}>ููุงูุงุช</option>
                    </select>
                </div>

                {% if plan %}
                <!-- Status (only for editing) -->
                <div>
                    <label for="status" class="block text-sm font-medium text-gray-700 mb-2" dir="rtl">ุงูุญุงูุฉ</label>
                    <select id="status" 
                            name="status" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500">
                        <option value="active" {{ 'selected' if plan.status == 'active' else '' }}>ูุดุท</option>
                        <option value="completed" {{ 'selected' if plan.status == 'completed' else '' }}>ููุชูู</option>
                        <option value="archived" {{ 'selected' if plan.status == 'archived' else '' }}>ูุคุฑุดู</option>
                    </select>
                </div>
                {% endif %}

                <!-- Tags -->
                <div class="{{ 'md:col-span-1' if plan else 'md:col-span-2' }}">
                    <label for="tags" class="block text-sm font-medium text-gray-700 mb-2" dir="rtl">ุงูุนูุงูุงุช</label>
                    <input type="text" 
                           id="tags" 
                           name="tags" 
                           value="{{ plan.tags if plan else '' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500"
                           placeholder="ูุซุงู: ุชุทููุฑุ ููุงุฑุงุชุ ุฃูุฏุงู (ููุตููุฉ ุจููุงุตู)"
                           dir="rtl">
                    <p class="text-xs text-gray-500 mt-1" dir="rtl">ุงูุชุจ ุงูุนูุงูุงุช ููุตููุฉ ุจููุงุตู</p>
                </div>

                <!-- Created By -->
                <div class="{{ 'md:col-span-2' if not plan else 'md:col-span-1' }}">
                    <label for="created_by" class="block text-sm font-medium text-gray-700 mb-2" dir="rtl">ููุดุฆ ุงูุฎุทุฉ</label>
                    <input type="text" 
                           id="created_by" 
                           name="created_by" 
                           value="{{ plan.created_by if plan else 'ูุฌููู' }}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500"
                           placeholder="ุงุณู ููุดุฆ ุงูุฎุทุฉ"
                           dir="rtl">
                </div>
            </div>



            <!-- Submit Buttons -->
            <div class="flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-200">
                <button type="submit" 
                        class="flex-1 sm:flex-none bg-cyan-600 hover:bg-cyan-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200">
                    {{ '๐พ ุญูุธ ุงูุชุนุฏููุงุช' if plan else 'โ ุฅูุดุงุก ุงูุฎุทุฉ' }}
                </button>
                
                <a href="{{ url_for('monthly_plans') }}" 
                   class="flex-1 sm:flex-none bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg font-medium text-center transition-colors duration-200">
                    โ ุฅูุบุงุก
                </a>
                
                {% if plan %}
                <a href="{{ url_for('edit_monthly_plan', plan_id=plan.id) }}" 
                   class="flex-1 sm:flex-none bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium text-center transition-colors duration-200">
                    ๐ ุฅุฏุงุฑุฉ ุงููุนุงูู
                </a>
                {% endif %}
            </div>
        </form>
    </div>

    <!-- Tips Section -->
    <div class="mt-6 bg-cyan-50 border border-cyan-200 rounded-lg p-4">
        <h3 class="text-lg font-semibold text-cyan-950 mb-3" dir="rtl">๐ก ูุตุงุฆุญ ูุฎุทุฉ ุดูุฑูุฉ ูุนุงูุฉ</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-cyan-800">
            <div dir="rtl">
                <strong>๐ฏ ุฃูุฏุงู ูุงุถุญุฉ:</strong> ุฃุถู 3-7 ุฃูุฏุงู ูุญุฏุฏุฉ ููุงุจูุฉ ููููุงุณ
            </div>
            <div dir="rtl">
                <strong>โฐ ููุงุนูุฏ ููุงุฆูุฉ:</strong> ุถุน ุชูุงุฑูุฎ ูุณุชูุฏูุฉ ููู ูุฏู
            </div>
            <div dir="rtl">
                <strong>๐ ุชุชุจุน ุงูุชูุฏู:</strong> ุฑุงุฌุน ุฃูุฏุงูู ุฃุณุจูุนูุงู ูุญุฏุซ ุญุงูุชูุง
            </div>
            <div dir="rtl">
                <strong>๐ ูุฑููุฉ:</strong> ููููู ุฅุถุงูุฉ ุฃู ุชุนุฏูู ุงูุฃูุฏุงู ุฎูุงู ุงูุดูุฑ
            </div>
        </div>
    </div>
</div>

<script>
// Set current month and year as default for new plans
document.addEventListener('DOMContentLoaded', function() {
    {% if not plan %}
    const now = new Date();
    const currentMonth = now.getMonth() + 1;
    const currentYear = now.getFullYear();
    
    document.getElementById('month').value = currentMonth;
    document.getElementById('year').value = currentYear;
    {% endif %}
});
</script>
{% endblock %}
